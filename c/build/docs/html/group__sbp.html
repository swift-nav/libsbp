<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>libsbp: SBP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libsbp
   &#160;<span id="projectnumber">v0.32-6-g73c6eb1-dirty</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__sbp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SBP<div class="ingroups"><a class="el" href="group__io.html">Input / Output</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Send and receive messages using Swift Binary Protocol.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for SBP:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__sbp.png" border="0" alt="" usemap="#group____sbp"/>
<map name="group____sbp" id="group____sbp">
<area shape="rect" id="node1" href="group__io.html" title="Input / Output" alt="" coords="6,5,109,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsbp__msg__callbacks__node.html">sbp_msg_callbacks_node</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SBP callback node.  <a href="structsbp__msg__callbacks__node.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsbp__state__t.html">sbp_state_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">State structure for processing SBP messages.  <a href="structsbp__state__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab1bfbe8241e7d61d1dcb70fdbc6f5298"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#gab1bfbe8241e7d61d1dcb70fdbc6f5298">SBP_OK</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:gab1bfbe8241e7d61d1dcb70fdbc6f5298"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating success.  <a href="#gab1bfbe8241e7d61d1dcb70fdbc6f5298">More...</a><br /></td></tr>
<tr class="separator:gab1bfbe8241e7d61d1dcb70fdbc6f5298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4413cd9bfd4381243c814ad16c378c92"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga4413cd9bfd4381243c814ad16c378c92">SBP_OK_CALLBACK_EXECUTED</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga4413cd9bfd4381243c814ad16c378c92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating message decoded and callback executed by sbp_process.  <a href="#ga4413cd9bfd4381243c814ad16c378c92">More...</a><br /></td></tr>
<tr class="separator:ga4413cd9bfd4381243c814ad16c378c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b31cea8a8193070f96a1a6dba858581"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga5b31cea8a8193070f96a1a6dba858581">SBP_OK_CALLBACK_UNDEFINED</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga5b31cea8a8193070f96a1a6dba858581"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating message decoded with no associated callback in sbp_process.  <a href="#ga5b31cea8a8193070f96a1a6dba858581">More...</a><br /></td></tr>
<tr class="separator:ga5b31cea8a8193070f96a1a6dba858581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeeedd7321786d9510dc9cf48a3e266bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#gaeeedd7321786d9510dc9cf48a3e266bf">SBP_CALLBACK_ERROR</a>&#160;&#160;&#160;-1</td></tr>
<tr class="memdesc:gaeeedd7321786d9510dc9cf48a3e266bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating an error with the callback (function defined).  <a href="#gaeeedd7321786d9510dc9cf48a3e266bf">More...</a><br /></td></tr>
<tr class="separator:gaeeedd7321786d9510dc9cf48a3e266bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf59365a3b5495dffbe085efb604235b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#gaf59365a3b5495dffbe085efb604235b7">SBP_CRC_ERROR</a>&#160;&#160;&#160;-2</td></tr>
<tr class="memdesc:gaf59365a3b5495dffbe085efb604235b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating a CRC error.  <a href="#gaf59365a3b5495dffbe085efb604235b7">More...</a><br /></td></tr>
<tr class="separator:gaf59365a3b5495dffbe085efb604235b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6dd3e7910da229b12648359d69fbe71"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#gab6dd3e7910da229b12648359d69fbe71">SBP_SEND_ERROR</a>&#160;&#160;&#160;-3</td></tr>
<tr class="memdesc:gab6dd3e7910da229b12648359d69fbe71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating an error occured whilst sending an SBP message.  <a href="#gab6dd3e7910da229b12648359d69fbe71">More...</a><br /></td></tr>
<tr class="separator:gab6dd3e7910da229b12648359d69fbe71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71d1c929c19e62f8ed7ce015d5d38413"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga71d1c929c19e62f8ed7ce015d5d38413">SBP_NULL_ERROR</a>&#160;&#160;&#160;-4</td></tr>
<tr class="memdesc:ga71d1c929c19e62f8ed7ce015d5d38413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value indicating an error occured because an argument was NULL.  <a href="#ga71d1c929c19e62f8ed7ce015d5d38413">More...</a><br /></td></tr>
<tr class="separator:ga71d1c929c19e62f8ed7ce015d5d38413"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga196882c04c16639a4395a436065c6068"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga196882c04c16639a4395a436065c6068">sbp_msg_callback_t</a> )(<a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> sender_id, <a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> len, <a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> msg[], void *context)</td></tr>
<tr class="memdesc:ga196882c04c16639a4395a436065c6068"><td class="mdescLeft">&#160;</td><td class="mdescRight">SBP callback function prototype definition.  <a href="#ga196882c04c16639a4395a436065c6068">More...</a><br /></td></tr>
<tr class="separator:ga196882c04c16639a4395a436065c6068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69dc672590b2d79ba11f98dbaa0b33bc"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak" />
<a class="el" href="structsbp__msg__callbacks__node.html">sbp_msg_callbacks_node</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc">sbp_msg_callbacks_node_t</a></td></tr>
<tr class="memdesc:ga69dc672590b2d79ba11f98dbaa0b33bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">SBP callback node.  <a href="#ga69dc672590b2d79ba11f98dbaa0b33bc">More...</a><br /></td></tr>
<tr class="separator:ga69dc672590b2d79ba11f98dbaa0b33bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga06fc87d81c62e9abb8790b6e5713c55b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="group__sbp.html#gga06fc87d81c62e9abb8790b6e5713c55ba757971c0bc5a1972d5f1b1be2c0e2087">WAITING</a> = 0, 
<a class="el" href="group__sbp.html#gga06fc87d81c62e9abb8790b6e5713c55ba9d77c0f7e14e04b7ecc95a029f669d83">GET_TYPE</a>, 
<a class="el" href="group__sbp.html#gga06fc87d81c62e9abb8790b6e5713c55ba66e9db660e0b9a41a016ee9aa17f1c8e">GET_SENDER</a>, 
<a class="el" href="group__sbp.html#gga06fc87d81c62e9abb8790b6e5713c55ba965c0199bc105c4df58589bb6b228a83">GET_LEN</a>, 
<br />
&#160;&#160;<a class="el" href="group__sbp.html#gga06fc87d81c62e9abb8790b6e5713c55baaaf15d67df991987408d4e77f15ff9e5">GET_MSG</a>, 
<a class="el" href="group__sbp.html#gga06fc87d81c62e9abb8790b6e5713c55bab043f4d9680ee3c06b3c0f7371da131b">GET_CRC</a>
<br />
 }</td></tr>
<tr class="separator:ga06fc87d81c62e9abb8790b6e5713c55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga166014b1150a21e4421ecf1575a409f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__common__inttypes.html#ga9e382f207c65ca13ab4ae98363aeda80">s8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga166014b1150a21e4421ecf1575a409f5">sbp_register_callback</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s, <a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> msg_type, <a class="el" href="group__sbp.html#ga196882c04c16639a4395a436065c6068">sbp_msg_callback_t</a> cb, void *context, <a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc">sbp_msg_callbacks_node_t</a> *node)</td></tr>
<tr class="memdesc:ga166014b1150a21e4421ecf1575a409f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a callback for a message type.  <a href="#ga166014b1150a21e4421ecf1575a409f5">More...</a><br /></td></tr>
<tr class="separator:ga166014b1150a21e4421ecf1575a409f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13d29e90d75e4cf2b589cab02364adf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga13d29e90d75e4cf2b589cab02364adf2">sbp_clear_callbacks</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s)</td></tr>
<tr class="memdesc:ga13d29e90d75e4cf2b589cab02364adf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all registered callbacks.  <a href="#ga13d29e90d75e4cf2b589cab02364adf2">More...</a><br /></td></tr>
<tr class="separator:ga13d29e90d75e4cf2b589cab02364adf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7eab683829921c0b25b979970c2b7293"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc">sbp_msg_callbacks_node_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga7eab683829921c0b25b979970c2b7293">sbp_find_callback</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s, <a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> msg_type)</td></tr>
<tr class="memdesc:ga7eab683829921c0b25b979970c2b7293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the callback function associated with a message type.  <a href="#ga7eab683829921c0b25b979970c2b7293">More...</a><br /></td></tr>
<tr class="separator:ga7eab683829921c0b25b979970c2b7293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga973aa9691a5d5b04dddf4312637d9d53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga973aa9691a5d5b04dddf4312637d9d53">sbp_state_init</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s)</td></tr>
<tr class="memdesc:ga973aa9691a5d5b04dddf4312637d9d53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize an <a class="el" href="structsbp__state__t.html" title="State structure for processing SBP messages. ">sbp_state_t</a> struct before use.  <a href="#ga973aa9691a5d5b04dddf4312637d9d53">More...</a><br /></td></tr>
<tr class="separator:ga973aa9691a5d5b04dddf4312637d9d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32004b9a1589b99a3066b9abeee09e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga32004b9a1589b99a3066b9abeee09e7a">sbp_state_set_io_context</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s, void *context)</td></tr>
<tr class="memdesc:ga32004b9a1589b99a3066b9abeee09e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a context to pass to all function pointer calls made by sbp functions This helper function sets a void* context pointer in sbp_state.  <a href="#ga32004b9a1589b99a3066b9abeee09e7a">More...</a><br /></td></tr>
<tr class="separator:ga32004b9a1589b99a3066b9abeee09e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e3947801d6a64382a7d7cafb09258ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__common__inttypes.html#ga9e382f207c65ca13ab4ae98363aeda80">s8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba">sbp_process</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s, <a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a>(*read)(<a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buff, <a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> n, void *context))</td></tr>
<tr class="memdesc:ga2e3947801d6a64382a7d7cafb09258ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and process SBP messages.  <a href="#ga2e3947801d6a64382a7d7cafb09258ba">More...</a><br /></td></tr>
<tr class="separator:ga2e3947801d6a64382a7d7cafb09258ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga358e73f0e2cbb8343b434956ba24390b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__common__inttypes.html#ga9e382f207c65ca13ab4ae98363aeda80">s8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sbp.html#ga358e73f0e2cbb8343b434956ba24390b">sbp_send_message</a> (<a class="el" href="structsbp__state__t.html">sbp_state_t</a> *s, <a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> msg_type, <a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> sender_id, <a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> len, <a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *payload, <a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a>(*write)(<a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buff, <a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> n, void *context))</td></tr>
<tr class="memdesc:ga358e73f0e2cbb8343b434956ba24390b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send SBP messages.  <a href="#ga358e73f0e2cbb8343b434956ba24390b">More...</a><br /></td></tr>
<tr class="separator:ga358e73f0e2cbb8343b434956ba24390b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Send and receive messages using Swift Binary Protocol. </p>
<h1>Examples </h1>
<h2>Receiving </h2>
<p>First setup a callback for the message you will be receiving. Our callback function must have type <a class="el" href="group__sbp.html#ga196882c04c16639a4395a436065c6068" title="SBP callback function prototype definition. ">sbp_msg_callback_t</a>, i.e. it must be of the form:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> my_callback(<a class="code" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> sender_id, <a class="code" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> len, <a class="code" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> msg[], <span class="keywordtype">void</span> *context)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Process msg.</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>You must also statically allocate a <a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc" title="SBP callback node. ">sbp_msg_callbacks_node_t</a> that will be used to keep track of the callback function. You do not need to initialize it as this will be done by <a class="el" href="group__sbp.html#ga166014b1150a21e4421ecf1575a409f5" title="Register a callback for a message type. ">sbp_register_callback()</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code" href="structsbp__msg__callbacks__node.html">sbp_msg_callbacks_node_t</a> my_callback_node;</div>
</div><!-- fragment --><p>Now register your callback function with the SBP library as follows:</p>
<div class="fragment"><div class="line"><a class="code" href="group__sbp.html#ga166014b1150a21e4421ecf1575a409f5">sbp_register_callback</a>(&amp;sbp_state, SBP_MY_MSG_TYPE, &amp;my_callback, &amp;context, &amp;my_callback_node);</div>
</div><!-- fragment --><p>where <code>SBP_MY_MSG_TYPE</code> is the numerical identifier of your message type.</p>
<p>You must now call <a class="el" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba" title="Read and process SBP messages. ">sbp_process()</a> periodically whenever you have received SBP data to be processed, e.g. from the serial port. Remember <a class="el" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba" title="Read and process SBP messages. ">sbp_process()</a> may not use all available data so keep calling <a class="el" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba" title="Read and process SBP messages. ">sbp_process()</a> until all the received serial data has been consumed.</p>
<p><a class="el" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba" title="Read and process SBP messages. ">sbp_process()</a> stores its internal state in an <a class="el" href="structsbp__state__t.html" title="State structure for processing SBP messages. ">sbp_state_t</a> struct which must be initialized by calling <a class="el" href="group__sbp.html#ga973aa9691a5d5b04dddf4312637d9d53" title="Initialize an sbp_state_t struct before use. ">sbp_state_init()</a> before its first use.</p>
<p>Here is an example based on reading from a typical UART interface:</p>
<div class="fragment"><div class="line"><a class="code" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> my_read(<a class="code" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buff, <a class="code" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> n, <span class="keywordtype">void</span> *context)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> i=0; i&lt;n; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (uart_has_data())</div>
<div class="line">      buff[i] = uart_read_char();</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> i;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  ...</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structsbp__state__t.html">sbp_state_t</a> s;</div>
<div class="line">  <a class="code" href="group__sbp.html#ga973aa9691a5d5b04dddf4312637d9d53">sbp_state_init</a>(&amp;s);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">while</span>(uart_has_data()) {</div>
<div class="line">    <a class="code" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba">sbp_process</a>(&amp;s, &amp;my_read);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><p>If you're writing C++ code that wants to reference a pointer to an object in the my_read function, you can use the context set by calling <a class="el" href="group__sbp.html#ga32004b9a1589b99a3066b9abeee09e7a" title="Set a context to pass to all function pointer calls made by sbp functions This helper function sets a...">sbp_state_set_io_context()</a></p>
<h2>Sending </h2>
<p>To send an SBP message simply call the <a class="el" href="group__sbp.html#ga358e73f0e2cbb8343b434956ba24390b" title="Send SBP messages. ">sbp_send_message()</a> function, providing a <code>write</code> function that writes data to your output.</p>
<p>Often the data to be sent will simply be a struct cast to a <code>u8</code> buffer. As a convenience you may want to define a macro that automatically includes your write function and calculates the size of the item to be sent.</p>
<div class="fragment"><div class="line"><span class="comment">// Convenience macro for sending an SBP message.</span></div>
<div class="line"><span class="preprocessor">#define SBP_MSG(sbp_state, msg_type, item) \</span></div>
<div class="line"><span class="preprocessor">  sbp_send_message(&amp;sbp_state, msg_type, MY_SENDER_ID, \</span></div>
<div class="line"><span class="preprocessor">      sizeof(item), (u8 *)&amp;(item), &amp;my_write)</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">  <a class="code" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> x, y;</div>
<div class="line">} my_awesome_struct;</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> my_write(<a class="code" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buff, <a class="code" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> n, <span class="keywordtype">void</span> *context)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> i=0; i&lt;n; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (uart_write_char(buff[i]) == ERROR)</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> i;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  ...</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structsbp__state__t.html">sbp_state_t</a> s;</div>
<div class="line">  <a class="code" href="group__sbp.html#ga973aa9691a5d5b04dddf4312637d9d53">sbp_state_init</a>(&amp;s);</div>
<div class="line"></div>
<div class="line">  my_awesome_struct payload = { 0x22, 0x33 };</div>
<div class="line"></div>
<div class="line">  <a class="code" href="group__sbp.html#ga358e73f0e2cbb8343b434956ba24390b">sbp_send_message</a>(&amp;s, SBP_MY_MSG_TYPE, MY_SENDER_ID,</div>
<div class="line">                   <span class="keyword">sizeof</span>(payload), (<a class="code" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a>*)&amp;payload, &amp;my_write);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// or</span></div>
<div class="line"></div>
<div class="line">  SBP_MSG(s, SBP_MY_MSG_TYPE, payload);</div>
<div class="line"></div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --> <h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gaeeedd7321786d9510dc9cf48a3e266bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_CALLBACK_ERROR&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating an error with the callback (function defined). </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00028">28</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaf59365a3b5495dffbe085efb604235b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_CRC_ERROR&#160;&#160;&#160;-2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating a CRC error. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00030">30</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga71d1c929c19e62f8ed7ce015d5d38413"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_NULL_ERROR&#160;&#160;&#160;-4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating an error occured because an argument was NULL. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00034">34</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="gab1bfbe8241e7d61d1dcb70fdbc6f5298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_OK&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating success. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00022">22</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga4413cd9bfd4381243c814ad16c378c92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_OK_CALLBACK_EXECUTED&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating message decoded and callback executed by sbp_process. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00024">24</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5b31cea8a8193070f96a1a6dba858581"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_OK_CALLBACK_UNDEFINED&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating message decoded with no associated callback in sbp_process. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00026">26</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="gab6dd3e7910da229b12648359d69fbe71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SBP_SEND_ERROR&#160;&#160;&#160;-3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return value indicating an error occured whilst sending an SBP message. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00032">32</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga196882c04c16639a4395a436065c6068"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* sbp_msg_callback_t)(<a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a> sender_id, <a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> len, <a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> msg[], void *context)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SBP callback function prototype definition. </p>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00038">38</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga69dc672590b2d79ba11f98dbaa0b33bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsbp__msg__callbacks__node.html">sbp_msg_callbacks_node</a>  <a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc">sbp_msg_callbacks_node_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SBP callback node. </p>
<p>Forms a linked list of callbacks. </p><dl class="section note"><dt>Note</dt><dd>Must be statically allocated for use with <a class="el" href="group__sbp.html#ga166014b1150a21e4421ecf1575a409f5" title="Register a callback for a message type. ">sbp_register_callback()</a>. </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga06fc87d81c62e9abb8790b6e5713c55b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga06fc87d81c62e9abb8790b6e5713c55ba757971c0bc5a1972d5f1b1be2c0e2087"></a>WAITING&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga06fc87d81c62e9abb8790b6e5713c55ba9d77c0f7e14e04b7ecc95a029f669d83"></a>GET_TYPE&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga06fc87d81c62e9abb8790b6e5713c55ba66e9db660e0b9a41a016ee9aa17f1c8e"></a>GET_SENDER&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga06fc87d81c62e9abb8790b6e5713c55ba965c0199bc105c4df58589bb6b228a83"></a>GET_LEN&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga06fc87d81c62e9abb8790b6e5713c55baaaf15d67df991987408d4e77f15ff9e5"></a>GET_MSG&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga06fc87d81c62e9abb8790b6e5713c55bab043f4d9680ee3c06b3c0f7371da131b"></a>GET_CRC&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="sbp_8h_source.html#l00053">53</a> of file <a class="el" href="sbp_8h_source.html">sbp.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga13d29e90d75e4cf2b589cab02364adf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sbp_clear_callbacks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear all registered callbacks. </p>
<p>This is probably only useful for testing but who knows! </p>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00208">208</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sbp_ga13d29e90d75e4cf2b589cab02364adf2_icgraph.png" border="0" usemap="#group__sbp_ga13d29e90d75e4cf2b589cab02364adf2_icgraph" alt=""/></div>
<map name="group__sbp_ga13d29e90d75e4cf2b589cab02364adf2_icgraph" id="group__sbp_ga13d29e90d75e4cf2b589cab02364adf2_icgraph">
<area shape="rect" id="node2" href="group__sbp.html#ga973aa9691a5d5b04dddf4312637d9d53" title="Initialize an sbp_state_t struct before use. " alt="" coords="197,5,301,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7eab683829921c0b25b979970c2b7293"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc">sbp_msg_callbacks_node_t</a>* sbp_find_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a>&#160;</td>
          <td class="paramname"><em>msg_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the callback function associated with a message type. </p>
<p>Searches through the list of registered callbacks to find the callback associated with the passed message type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg_type</td><td>Message type to find callback for </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to callback node (<a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc" title="SBP callback node. ">sbp_msg_callbacks_node_t</a>) or <code>NULL</code> if callback not found for that message type. </dd></dl>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00222">222</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sbp_ga7eab683829921c0b25b979970c2b7293_icgraph.png" border="0" usemap="#group__sbp_ga7eab683829921c0b25b979970c2b7293_icgraph" alt=""/></div>
<map name="group__sbp_ga7eab683829921c0b25b979970c2b7293_icgraph" id="group__sbp_ga7eab683829921c0b25b979970c2b7293_icgraph">
<area shape="rect" id="node2" href="group__sbp.html#ga166014b1150a21e4421ecf1575a409f5" title="Register a callback for a message type. " alt="" coords="182,5,333,32"/><area shape="rect" id="node3" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba" title="Read and process SBP messages. " alt="" coords="209,56,306,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga2e3947801d6a64382a7d7cafb09258ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__common__inttypes.html#ga9e382f207c65ca13ab4ae98363aeda80">s8</a> sbp_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a>(*)(<a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buff, <a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> n, void *context)&#160;</td>
          <td class="paramname"><em>read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read and process SBP messages. </p>
<p>Reads bytes from an input source using the provided <code>read</code> function, decodes the SBP framing and performs a CRC check on the message.</p>
<p>When an SBP message is successfully received then the list of callbacks is searched for a callback corresponding to the received message type. If a callback is found then it is called with the ID of the sender, the message length and the message payload data buffer as arguments.</p>
<dl class="section note"><dt>Note</dt><dd>sbp_process will always call <code>read</code> with n &gt; 0 (aka it will attempt to always read something)</dd></dl>
<p>The supplied <code>read</code> function must have the prototype:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;u32 read(u8 *buff, u32 n, void* context)</div>
</div><!-- fragment --><p>where <code>n</code> is the number of bytes requested and <code>buff</code> is the buffer into which to write the received data, and <code>context</code> is the arbitrary pointer set by <code>sbp_state_set_io_context</code>. The function should return the number of bytes successfully written into <code>buff</code> which may be between 0 and <code>n</code> inclusive, but must never be greater than <code>n</code>.</p>
<p>Note that <code>sbp_process</code> may not read all available bytes from the <code>read</code> function so the caller should loop until all bytes available from the input source have been consumed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>State structure </td></tr>
    <tr><td class="paramname">read</td><td>Function pointer to a function that reads <code>n</code> bytes from the input source into <code>buff</code> and returns the number of bytes successfully read. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SBP_OK</code> (0) if successful but no complete message yet, <code>SBP_OK_CALLBACK_EXECUTED</code> (1) if message decoded and callback executed, <code>SBP_OK_CALLBACK_UNDEFINED</code> (2) if message decoded with no associated callback, and <code>SBP_CRC_ERROR</code> (-2) if a CRC error has occurred. Thus can check for &gt;0 to ensure good processing. </dd></dl>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00312">312</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sbp_ga2e3947801d6a64382a7d7cafb09258ba_cgraph.png" border="0" usemap="#group__sbp_ga2e3947801d6a64382a7d7cafb09258ba_cgraph" alt=""/></div>
<map name="group__sbp_ga2e3947801d6a64382a7d7cafb09258ba_cgraph" id="group__sbp_ga2e3947801d6a64382a7d7cafb09258ba_cgraph">
<area shape="rect" id="node2" href="group__crc.html#gacde7cc46c9abec51644b9ba951ba957c" title="Calculate CCITT 16&#45;bit Cyclical Redundancy Check (CRC16). " alt="" coords="173,5,259,32"/><area shape="rect" id="node3" href="group__sbp.html#ga7eab683829921c0b25b979970c2b7293" title="Find the callback function associated with a message type. " alt="" coords="152,56,280,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga166014b1150a21e4421ecf1575a409f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__common__inttypes.html#ga9e382f207c65ca13ab4ae98363aeda80">s8</a> sbp_register_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a>&#160;</td>
          <td class="paramname"><em>msg_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__sbp.html#ga196882c04c16639a4395a436065c6068">sbp_msg_callback_t</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc">sbp_msg_callbacks_node_t</a> *&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a callback for a message type. </p>
<p>Register a callback that is called when a message with type msg_type is received.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg_type</td><td>Message type associated with callback </td></tr>
    <tr><td class="paramname">cb</td><td>Pointer to message callback function </td></tr>
    <tr><td class="paramname">context</td><td>Pointer to context for callback function </td></tr>
    <tr><td class="paramname">node</td><td>Statically allocated <a class="el" href="group__sbp.html#ga69dc672590b2d79ba11f98dbaa0b33bc" title="SBP callback node. ">sbp_msg_callbacks_node_t</a> struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SBP_OK</code> (0) if successful, <code>SBP_CALLBACK_ERROR</code> if callback was already registered for that message type. </dd></dl>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00161">161</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sbp_ga166014b1150a21e4421ecf1575a409f5_cgraph.png" border="0" usemap="#group__sbp_ga166014b1150a21e4421ecf1575a409f5_cgraph" alt=""/></div>
<map name="group__sbp_ga166014b1150a21e4421ecf1575a409f5_cgraph" id="group__sbp_ga166014b1150a21e4421ecf1575a409f5_cgraph">
<area shape="rect" id="node2" href="group__sbp.html#ga7eab683829921c0b25b979970c2b7293" title="Find the callback function associated with a message type. " alt="" coords="205,5,333,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga358e73f0e2cbb8343b434956ba24390b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__common__inttypes.html#ga9e382f207c65ca13ab4ae98363aeda80">s8</a> sbp_send_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a>&#160;</td>
          <td class="paramname"><em>msg_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#gace9d960e74685e2cd84b36132dbbf8aa">u16</a>&#160;</td>
          <td class="paramname"><em>sender_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a>(*)(<a class="el" href="group__common__inttypes.html#ga92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buff, <a class="el" href="group__common__inttypes.html#gafaa62991928fb9fb18ff0db62a040aba">u32</a> n, void *context)&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send SBP messages. </p>
<p>Takes an SBP message payload, type and sender ID then writes a message to the output stream using the supplied <code>write</code> function with the correct framing and CRC.</p>
<p>The supplied <code>write</code> function must have the prototype:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;u32 write(u8 *buff, u32 n, void* context)</div>
</div><!-- fragment --><p>where <code>n</code> is the number of bytes to be written and <code>buff</code> is the buffer from which to read the data to be written, and <code>context</code> is the arbitrary pointer set by <code>sbp_state_set_io_context</code>. The function should return the number of bytes successfully written which may be between 0 and <code>n</code>. Currently, if the number of bytes written is different from <code>n</code> then <code>sbp_send_message</code> will immediately return with an error.</p>
<p>Note that <code>sbp_send_message</code> makes multiple calls to write and therefore if a <code>write</code> call fails then this may result in a partial message being written to the output. This should be caught by the CRC check on the receiving end but will result in lost messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">write</td><td>Function pointer to a function that writes <code>n</code> bytes from <code>buff</code> to the output stream and returns the number of bytes successfully written. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SBP_OK</code> (0) if successful, <code>SBP_WRITE_ERROR</code> if the message could not be sent or was only partially sent. </dd></dl>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00428">428</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sbp_ga358e73f0e2cbb8343b434956ba24390b_cgraph.png" border="0" usemap="#group__sbp_ga358e73f0e2cbb8343b434956ba24390b_cgraph" alt=""/></div>
<map name="group__sbp_ga358e73f0e2cbb8343b434956ba24390b_cgraph" id="group__sbp_ga358e73f0e2cbb8343b434956ba24390b_cgraph">
<area shape="rect" id="node2" href="group__crc.html#gacde7cc46c9abec51644b9ba951ba957c" title="Calculate CCITT 16&#45;bit Cyclical Redundancy Check (CRC16). " alt="" coords="195,5,280,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga973aa9691a5d5b04dddf4312637d9d53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sbp_state_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize an <a class="el" href="structsbp__state__t.html" title="State structure for processing SBP messages. ">sbp_state_t</a> struct before use. </p>
<p>This resets the entire state, including all callbacks. Remember to use this function to initialize the state before calling <a class="el" href="group__sbp.html#ga2e3947801d6a64382a7d7cafb09258ba" title="Read and process SBP messages. ">sbp_process()</a> for the first time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>State structure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00250">250</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sbp_ga973aa9691a5d5b04dddf4312637d9d53_cgraph.png" border="0" usemap="#group__sbp_ga973aa9691a5d5b04dddf4312637d9d53_cgraph" alt=""/></div>
<map name="group__sbp_ga973aa9691a5d5b04dddf4312637d9d53_cgraph" id="group__sbp_ga973aa9691a5d5b04dddf4312637d9d53_cgraph">
<area shape="rect" id="node2" href="group__sbp.html#ga13d29e90d75e4cf2b589cab02364adf2" title="Clear all registered callbacks. " alt="" coords="158,5,301,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga32004b9a1589b99a3066b9abeee09e7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sbp_state_set_io_context </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsbp__state__t.html">sbp_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a context to pass to all function pointer calls made by sbp functions This helper function sets a void* context pointer in sbp_state. </p>
<p>Whenever <code>sbp_process</code> calls the <code>read</code> function pointer, it passes this context. Whenever <code>sbp_send_message</code> calls the <code>write</code> function pointer, it passes this context. This allows C++ code to get a pointer to an object inside these functions. </p>

<p>Definition at line <a class="el" href="sbp_8c_source.html#l00268">268</a> of file <a class="el" href="sbp_8c_source.html">sbp.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Apr 15 2015 14:07:47 for libsbp by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
