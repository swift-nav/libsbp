
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>FileIo format specification</title>
  </head>
  <body>
           <div class="container">
  <h1>FileIo format specification</h1>

      
<a name='type-file_io'></a>
<h1>Type: FileIo</h1>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
</table>
<a name='type-file_io-msg_fileio_write_req'></a>
<h2>Type: MsgFileioWriteReq</h2>

<p>The file write message writes a certain length (up to 255 bytes) of data
to a file at a given offset. Returns a copy of the original
MSG_FILEIO_WRITE_RESP message to check integrity of the write. The
sequence number in the request will be returned in the response. If
message is invalid, a followup MSG_PRINT message will print "Invalid
fileio write message". A device will only process this message when it
is received from sender ID 0x42.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Write sequence number
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>offset</td>
<td>u4le</td>
<td>Offset into the file at which to start writing in bytes
</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>filename</td>
<td>str(ascii)</td>
<td>Name of the file to write to
</td>
</tr>
<tr>
<td>???</td>
<td>...</td>
<td>data</td>
<td>u1</td>
<td>Variable-length array of data to write
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_config_resp'></a>
<h2>Type: MsgFileioConfigResp</h2>

<p>The advice on the optimal configuration for a FileIO transfer.  Newer
version of FileIO can support greater throughput by supporting a large
window of FileIO data that can be in-flight during read or write
operations.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Advice sequence number
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>window_size</td>
<td>u4le</td>
<td>The number of SBP packets in the data in-flight window
</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>batch_size</td>
<td>u4le</td>
<td>The number of SBP packets sent in one PDU
</td>
</tr>
<tr>
<td>12</td>
<td>...</td>
<td>fileio_version</td>
<td>u4le</td>
<td>The version of FileIO that is supported
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_remove'></a>
<h2>Type: MsgFileioRemove</h2>

<p>The file remove message deletes a file from the file system. If the
message is invalid, a followup MSG_PRINT message will print "Invalid
fileio remove message". A device will only process this message when it
is received from sender ID 0x42.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>filename</td>
<td>str(ascii)</td>
<td>Name of the file to delete
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_config_req'></a>
<h2>Type: MsgFileioConfigReq</h2>

<p>Requests advice on the optimal configuration for a FileIO transfer.
Newer version of FileIO can support greater throughput by supporting a
large window of FileIO data that can be in-flight during read or write
operations.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Advice sequence number
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_read_dir_req'></a>
<h2>Type: MsgFileioReadDirReq</h2>

<p>The read directory message lists the files in a directory on the
device's onboard flash file system.  The offset parameter can be used to
skip the first n elements of the file list. Returns a
MSG_FILEIO_READ_DIR_RESP message containing the directory listings as a
NULL delimited list. The listing is chunked over multiple SBP packets.
The sequence number in the request will be returned in the response.  If
message is invalid, a followup MSG_PRINT message will print "Invalid
fileio read message". A device will only respond to this message when it
is received from sender ID 0x42.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Read sequence number
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>offset</td>
<td>u4le</td>
<td>The offset to skip the first n elements of the file list
</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>dirname</td>
<td>str(ascii)</td>
<td>Name of the directory to list
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_write_resp'></a>
<h2>Type: MsgFileioWriteResp</h2>

<p>The file write message writes a certain length (up to 255 bytes) of data
to a file at a given offset. The message is a copy of the original
MSG_FILEIO_WRITE_REQ message to check integrity of the write. The
sequence number in the response is preserved from the request.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Write sequence number
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_read_dir_resp'></a>
<h2>Type: MsgFileioReadDirResp</h2>

<p>The read directory message lists the files in a directory on the
device's onboard flash file system. Message contains the directory
listings as a NULL delimited list. The listing is chunked over multiple
SBP packets and the end of the list is identified by an packet with no
entries. The sequence number in the response is preserved from the
request.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Read sequence number
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>contents</td>
<td>u1</td>
<td>Contents of read directory
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_read_req'></a>
<h2>Type: MsgFileioReadReq</h2>

<p>The file read message reads a certain length (up to 255 bytes) from a
given offset into a file, and returns the data in a MSG_FILEIO_READ_RESP
message where the message length field indicates how many bytes were
successfully read. The sequence number in the request will be returned
in the response. If the message is invalid, a followup MSG_PRINT message
will print "Invalid fileio read message". A device will only respond to
this message when it is received from sender ID 0x42.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Read sequence number
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>offset</td>
<td>u4le</td>
<td>File offset
</td>
</tr>
<tr>
<td>8</td>
<td>...</td>
<td>chunk_size</td>
<td>u1</td>
<td>Chunk size to read
</td>
</tr>
<tr>
<td>9</td>
<td>...</td>
<td>filename</td>
<td>str(ascii)</td>
<td>Name of the file to read from
</td>
</tr>
</table>
<a name='type-file_io-msg_fileio_read_resp'></a>
<h2>Type: MsgFileioReadResp</h2>

<p>The file read message reads a certain length (up to 255 bytes) from a
given offset into a file, and returns the data in a message where the
message length field indicates how many bytes were successfully read.
The sequence number in the response is preserved from the request.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>sequence</td>
<td>u4le</td>
<td>Read sequence number
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>contents</td>
<td>u1</td>
<td>Contents of read file
</td>
</tr>
</table>

  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </body>
</html>
      
