
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <title>Signing format specification</title>
  </head>
  <body>
           <div class="container">
  <h1>Signing format specification</h1>

      
<a name='type-signing'></a>
<h1>Type: Signing</h1>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
</table>
<a name='type-signing-msg_ed25519_signature_dep_b'></a>
<h2>Type: MsgEd25519SignatureDepB</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>stream_counter</td>
<td>u1</td>
<td>Signature message counter. Zero indexed and incremented with each
signature message.  The counter will not increment if this message
was in response to an on demand request.  The counter will roll over
after 256 messages. Upon connection, the value of the counter may
not initially be zero.
</td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>on_demand_counter</td>
<td>u1</td>
<td>On demand message counter. Zero indexed and incremented with each
signature message sent in response to an on demand message. The
counter will roll over after 256 messages.  Upon connection, the
value of the counter may not initially be zero.
</td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>signature</td>
<td>u1</td>
<td>ED25519 signature for messages.
</td>
</tr>
<tr>
<td>66</td>
<td>...</td>
<td>fingerprint</td>
<td>u1</td>
<td>SHA-1 fingerprint of the associated certificate.
</td>
</tr>
<tr>
<td>86</td>
<td>...</td>
<td>signed_messages</td>
<td>u4le</td>
<td>CRCs of signed messages.
</td>
</tr>
</table>
<a name='type-signing-msg_ed25519_certificate_dep'></a>
<h2>Type: MsgEd25519CertificateDep</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>n_msg</td>
<td>u1</td>
<td>Total number messages that make up the certificate. First nibble is
the size of the sequence (n), second nibble is the zero-indexed
counter (ith packet of n)
</td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>fingerprint</td>
<td>u1</td>
<td>SHA-1 fingerprint of the associated certificate.
</td>
</tr>
<tr>
<td>21</td>
<td>...</td>
<td>certificate_bytes</td>
<td>u1</td>
<td>ED25519 certificate bytes.
</td>
</tr>
</table>
<a name='type-signing-utc_time'></a>
<h2>Type: UtcTime</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>year</td>
<td>u2le</td>
<td>Year
</td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>month</td>
<td>u1</td>
<td>Month (range 1 .. 12)
</td>
</tr>
<tr>
<td>3</td>
<td>...</td>
<td>day</td>
<td>u1</td>
<td>days in the month (range 1-31)
</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>hours</td>
<td>u1</td>
<td>hours of day (range 0-23)
</td>
</tr>
<tr>
<td>5</td>
<td>...</td>
<td>minutes</td>
<td>u1</td>
<td>minutes of hour (range 0-59)
</td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>seconds</td>
<td>u1</td>
<td>seconds of minute (range 0-60) rounded down
</td>
</tr>
<tr>
<td>7</td>
<td>...</td>
<td>ns</td>
<td>u4le</td>
<td>nanoseconds of second (range 0-999999999)
</td>
</tr>
</table>
<a name='type-signing-msg_ed25519_signature_dep_a'></a>
<h2>Type: MsgEd25519SignatureDepA</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>signature</td>
<td>u1</td>
<td>ED25519 signature for messages.
</td>
</tr>
<tr>
<td>64</td>
<td>...</td>
<td>fingerprint</td>
<td>u1</td>
<td>SHA-1 fingerprint of the associated certificate.
</td>
</tr>
<tr>
<td>84</td>
<td>...</td>
<td>signed_messages</td>
<td>u4le</td>
<td>CRCs of signed messages.
</td>
</tr>
</table>
<a name='type-signing-msg_certificate_chain'></a>
<h2>Type: MsgCertificateChain</h2>

<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>root_certificate</td>
<td>u1</td>
<td>SHA-1 fingerprint of the root certificate
</td>
</tr>
<tr>
<td>20</td>
<td>...</td>
<td>intermediate_certificate</td>
<td>u1</td>
<td>SHA-1 fingerprint of the intermediate certificate
</td>
</tr>
<tr>
<td>40</td>
<td>...</td>
<td>corrections_certificate</td>
<td>u1</td>
<td>SHA-1 fingerprint of the corrections certificate
</td>
</tr>
<tr>
<td>60</td>
<td>...</td>
<td>expiration</td>
<td><a href="#type-signing-utc_time">UtcTime</a></td>
<td>The certificate chain comprised of three fingerprints: root
certificate, intermediate certificate and corrections certificate.
</td>
</tr>
<tr>
<td>71</td>
<td>...</td>
<td>signature</td>
<td>u1</td>
<td>An ECDSA signature (created by the root certificate) over the
concatenation of the SBP payload bytes preceding this field. That
is, the concatenation of `root_certificate`,
`intermediate_certificate`, `corrections_certificate` and
`expiration`.  This certificate chain (allow list) can also be
validated by fetching it from `http(s)://certs.swiftnav.com/chain`.
</td>
</tr>
</table>
<a name='type-signing-msg_ecdsa_certificate'></a>
<h2>Type: MsgEcdsaCertificate</h2>

<p>A DER encoded x.509 ECDSA-256 certificate (using curve secp256r1).
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>n_msg</td>
<td>u1</td>
<td>Total number messages that make up the certificate. The first nibble
(mask 0xF0 or left shifted by 4 bits) is the size of the sequence
(n), second nibble (mask 0x0F) is the zero-indexed counter (ith
packet of n).
</td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>certificate_id</td>
<td>u1</td>
<td>The last 4 bytes of the certificate's SHA-1 fingerprint
</td>
</tr>
<tr>
<td>5</td>
<td>...</td>
<td>flags</td>
<td>u1</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>...</td>
<td>certificate_bytes</td>
<td>u1</td>
<td>DER encoded x.509 ECDSA certificate bytes
</td>
</tr>
</table>
<a name='type-signing-msg_ecdsa_signature'></a>
<h2>Type: MsgEcdsaSignature</h2>

<p>An ECDSA-256 signature using SHA-256 as the message digest algorithm.
</p>
<table class="table">
<tr><th>Offset</th><th>Size</th><th>ID</th><th>Type</th><th>Note</th></tr>
<tr>
<td>0</td>
<td>...</td>
<td>flags</td>
<td>u1</td>
<td>Describes the format of the `signed\_messages` field below.
</td>
</tr>
<tr>
<td>1</td>
<td>...</td>
<td>stream_counter</td>
<td>u1</td>
<td>Signature message counter. Zero indexed and incremented with each
signature message.  The counter will not increment if this message
was in response to an on demand request.  The counter will roll over
after 256 messages. Upon connection, the value of the counter may
not initially be zero.
</td>
</tr>
<tr>
<td>2</td>
<td>...</td>
<td>on_demand_counter</td>
<td>u1</td>
<td>On demand message counter. Zero indexed and incremented with each
signature message sent in response to an on demand message. The
counter will roll over after 256 messages.  Upon connection, the
value of the counter may not initially be zero.
</td>
</tr>
<tr>
<td>3</td>
<td>...</td>
<td>certificate_id</td>
<td>u1</td>
<td>The last 4 bytes of the certificate's SHA-1 fingerprint
</td>
</tr>
<tr>
<td>7</td>
<td>...</td>
<td>signature</td>
<td>u1</td>
<td>ECDSA signature for the messages using SHA-256 as the digest
algorithm.
</td>
</tr>
<tr>
<td>71</td>
<td>...</td>
<td>signed_messages</td>
<td>u1</td>
<td>CRCs of the messages covered by this signature.  For Skylark, which
delivers SBP messages wrapped in Swift's proprietary RTCM message,
these are the 24-bit CRCs from the RTCM message framing. For SBP
only streams, this will be 16-bit CRCs from the SBP framing.  See
the `flags` field to determine the type of CRCs covered.
</td>
</tr>
</table>

  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </body>
</html>
      
